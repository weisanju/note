# 工作模式

![](/images/vi_work_mode.png)



1）命令模式：启动vi编辑器后默认进入命令模式，该模式中主要完成如光标移动、字符串查找，以及删除、复制、粘贴文件内容等相关操作

2）输入模式：该模式中主要的操作就是录入文件内容，可以对文本文件正文进行修改、或者添加新的内容。处于输入模式时，vi编辑器的最后一行会出现"-- INSERT --"的状态提示信息

3）末行模式：该模式中可以设置vi编辑环境、保存文件、退出编辑器，以及对文件内容进行查找、替换等操作。处于末行模式时，vi编辑器的最后一行会出现冒号":"提示符



# 命令模式的基本操作

## 光标移动

![](/images/vi_cursor_move.png)

## 复制、粘贴、删除

![](/images/vi_copy_paste_del.png)

## 撤销编辑及保存退出

![](/images/vi_edit_undo_save.png)

## 保存文件及退出vi编辑器

![](/images/vi_save_exit.png)

## 打开新文件或读入其他文件内容







# 删除行

```
# 1. 删除空行
:g/^$/d

# 2. 删除只包含空白字符（空格/回车/Tab制表符）的行
:g/^\s*$/d

# 3. 删除以 # 或 空格# 或 tab# 开头的行
:g/^\s*#/d

# 4. 如果当前行包含 hello，则删除当前行
:/hello/d

# 5. 删除从第二行到包含 hello 的区间行
:2,/hello/d

# 6. 删除从包含 hello 的行到最后一行区间的行
:/hello/,$d

# 7. 删除所有包含 hello 的行
:g/hello/d

# 8. 删除匹配 hello 且前面只有一个字符的行
:g/.hello/d

# 9. 删除匹配 hello 且以它开头的行
:g/^hello/d

# 10. 删除匹配 hello 且以它结尾的行
:g/hello$/d

# 11. 删除 # 之后所有字符串
%s/\#.*//g
```





# 显示空白行

空白行包括了空格、换行、Tab制表符等内容，在 vim 命令模式下可以通过命令 :set list 显示所有空白字符，"^I" 代表 Tab 制表符，“$” 代表换行符。



# **全局查找替换命令语法格式**

```
[addr]s/源字符串/目的字符串/[option]

[addr] 表示检索范围，省略时表示当前行。
（1）“1，20” 表示从第1行到20行；
（2）“%”       表示整个文件，同“1,$”；
（3）“. ,$”     表示从当前行到文件尾；

s : 表示替换操作

[option] : 表示操作类型，常见：
（1）g 表示全局替换; 
（2）c 表示进行确认
（3）d 表示进行删除
（4）p 表示替代结果逐行显示（Ctrl + L恢复屏幕）；

注意事项：
（1）省略option时仅对每行第一个匹配串进行替换；
（2）如果在源字符串和目的字符串中出现特殊字符，需要用”\”转义
```