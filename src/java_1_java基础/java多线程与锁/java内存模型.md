# Java内存模型

​		Java Memory Modle，简称 JMM，中文名称 **Java内存模型**，它是一个抽象的概念，用来描述或者规范访问内存变量的方式。因为各中计算机的操作系统和硬件不同，方式机制也可能不同，Java内存模型用于屏蔽（适配）各种差异，以此来达到访问各个平台的一致的效果。这也是Java夸平台的重要原因之一。



**主内存**

* 规定了所有变量都存储在主内存（Main Memory）中，各个线程又有自己的本地内存（工作内存）
* 本地内存保存着主内存中部分变量

**JVM内存操作指令**

1. **lock加锁：**为了保证访问主内存变量的线程安全性，在访问前一般会加锁处理；
2. **read读：**从主内存中读取一个变量到工作内存；
3. **load加载：**把read读到的变量加载到工作内存的变量副本中；
4. **use使用：**此时线程可以使用其工作内存中的变量了；
5. **assign赋值：**将处理后的变量赋值给工作内存中的变量；
6. **store存储：**将工作内存中的变量存储到主内存中，以新建new 一个新变量的方式存储；
7. **write写：**将store存在的新变量的引用赋值给被处理的变量；
8. **unload解锁：**所有的工作做完，最后解锁释放资源。





# Java内存模型的三大特性

**原子性**（Atomicity）

* 这里的原子性如同数据库事务中是原子性，一个或多个操作要么全执行成功要么全执行失败

* Java内存模型只保证单一的操作具有原子性

**可见性**（Visibility）

如何解决内存的可见性的问题

1. 对进入临界区的线程做同步处理（比如 synchronized）,同一时刻仅有一个线程能够访问临界区的资源；
2. 使用 volatile 关键字保证内存可见性，它能保证访问临界区资源的所有线程总能看到共享资源的最新值；
3. CAS无锁化。

**有序性**（Ordering

线程内的所有操作都是有序的，既程序执行的顺序按照代码的先后顺序执行

